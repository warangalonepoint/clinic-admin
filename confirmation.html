<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Confirm Booking</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #121212;
      color: #fff;
      padding: 20px;
    }
    h2 {
      color: #00e676;
    }
    .clinic-info, .details-box {
      background: #1e1e1e;
      padding: 16px;
      border-radius: 10px;
      margin-bottom: 20px;
    }
    .details-box p {
      margin: 8px 0;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      margin-right: 10px;
      cursor: pointer;
    }
    .confirm-btn {
      background-color: #1f88e5;
      color: #fff;
    }
    .cancel-btn {
      background-color: #555;
      color: #fff;
    }
    button:hover {
      opacity: 0.9;
    }
  </style>
</head>
<body>

  <!-- Access Protection -->
  <script>
    const clinic = localStorage.getItem("activeClinic");
    const pin = localStorage.getItem("userPIN");
    if (!clinic || !pin) {
      alert("Access denied. Please log in.");
      window.location.href = "index.html";
    }
  </script>

  <h2>ğŸ“‹ Confirm Your Appointment</h2>
  <div class="clinic-info">ğŸ¥ Active Clinic: <span id="clinicName"></span></div>

  <div class="details-box">
    <p><strong>ğŸ‘¤ Name:</strong> <span id="patientName"></span></p>
    <p><strong>ğŸ“ Reason:</strong> <span id="reason"></span></p>
    <p><strong>ğŸ“… Date:</strong> <span id="date"></span></p>
    <p><strong>ğŸ•’ Time:</strong> <span id="time"></span></p>
  </div>

  <button class="confirm-btn" onclick="confirmBooking()">âœ… Confirm & Continue</button>
  <button class="cancel-btn" onclick="goBack()">âŒ Cancel</button>

  <script>
    document.getElementById("clinicName").innerText = clinic;

    // Retrieve booking info passed from bookings.html
    const params = new URLSearchParams(window.location.search);
    const name = decodeURIComponent(params.get("name") || "");
    const reason = decodeURIComponent(params.get("reason") || "");
    const date = decodeURIComponent(params.get("date") || "");
    const time = decodeURIComponent(params.get("time") || "");

    document.getElementById("patientName").innerText = name;
    document.getElementById("reason").innerText = reason;
    document.getElementById("date").innerText = date;
    document.getElementById("time").innerText = time;

    function confirmBooking() {
      const message = `Appointment Request:\nğŸ‘¤ Name: ${name}\nğŸ¥ Clinic: ${clinic}\nğŸ“… Date: ${date}\nâ° Time: ${time}\nğŸ“ Reason: ${reason}`;
      const whatsappURL = `https://wa.me/919390664577?text=${encodeURIComponent(message)}`;
      window.location.href = whatsappURL;
    }

    function goBack() {
      window.location.href = "bookings.html";
    }
  </script>
</body>
</html>
