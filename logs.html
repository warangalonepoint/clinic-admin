<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Booking Logs and Daily Summary for Clinic Admin" />
  <meta name="theme-color" content="#111" />
  <title>Booking Logs</title>
  <link rel="manifest" href="manifest.json" />
  <style>
    body {
      background-color: #111;
      color: #fff;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    h2 {
      color: limegreen;
    }
    .log-card {
      background: #222;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 10px;
      box-shadow: 0 0 10px #000;
    }
    select, button, input {
      padding: 10px;
      margin: 10px 0;
      border-radius: 8px;
      border: none;
      font-size: 16px;
    }
    button {
      background-color: dodgerblue;
      color: white;
    }
  </style>
</head>
<body>
  <h2>ğŸ“Š Booking Logs</h2>
  <div id="clinicNameDisplay"></div>
  <select id="dateSelect"></select>
  <div id="logContainer"></div>
  <p id="summary"></p>
  <button onclick="exportLogs()">â¬‡ï¸ Export Logs</button>  <script>
    const activeClinic = localStorage.getItem('activeClinic') || 'Not Set';
    const clinicNameDisplay = document.getElementById('clinicNameDisplay');
    clinicNameDisplay.innerHTML = `<p>ğŸ¥ Active Clinic: ${activeClinic}</p>`;

    fetch('logs.csv')
      .then(res => res.text())
      .then(data => {
        const rows = data.trim().split('\n').slice(1);
        const logs = rows.map(row => {
          const [clinic, date, time, name, reason] = row.split(',');
          return { clinic, date, time, name, reason };
        }).filter(entry => entry.clinic === activeClinic);

        const dateSelect = document.getElementById('dateSelect');
        const dates = [...new Set(logs.map(log => log.date))];
        dates.forEach(date => {
          const opt = document.createElement('option');
          opt.value = date;
          opt.textContent = date;
          dateSelect.appendChild(opt);
        });

        dateSelect.addEventListener('change', () => renderLogs(dateSelect.value));

        function renderLogs(selectedDate) {
          const filtered = logs.filter(l => l.date === selectedDate);
          const logContainer = document.getElementById('logContainer');
          logContainer.innerHTML = '';
          filtered.forEach(log => {
            const div = document.createElement('div');
            div.className = 'log-card';
            div.innerHTML = `ğŸ‘¤ ${log.name}<br>ğŸ“… ${log.date}<br>â° ${log.time}<br>ğŸ“ ${log.reason}`;
            logContainer.appendChild(div);
          });
          document.getElementById('summary').innerText = `ğŸ“… Total bookings on ${selectedDate}: ${filtered.length}`;
        }
      });

    function exportLogs() {
      window.open('logs.csv', '_blank');
    }
  </script></body>
</html>
